apiVersion: apps/v1
kind: Deployment
metadata: 
  labels: 
    app: {{ .Release.Name }}
  name: {{ .Release.Name }}
  namespace: {{ .Release.Namespace }}
spec: 
  replicas: 1
  selector: 
    matchLabels: 
      app: {{ .Release.Name }}
  template: 
    metadata: 
      labels: 
        app: {{ .Release.Name }}
    spec: 
      containers: 
        - image: {{ .Values.containers.image }}
          name: pega-db
          args: ["-c","max_connections={{ .Values.containers.maxConnections }}"]
          ports: 
            - containerPort: 5432
              protocol: TCP
          volumeMounts: 
            - mountPath: {{ .Values.containers.volumeMounts.mountPath }}
              name: postgresql-data
      volumes: 
        - hostPath: 
            path: {{ .Values.volumes.hostPath }}
            type: Directory
          name: postgresql-data
